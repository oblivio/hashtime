function HashTime(a,b){this.hashPrefix="/",this.renderedTPL="",this.landinghash="",this.lasthash="",this.lasthashes=[],this.currenthash="",this.landingHTMLPage="",this.URLParameters=[],this.URLQuery="",this.titledata={},this.templatedata={},this.template=null,this.sharedtemplatedata={},this.partials=[],this.imagesToPreload=[],this.onDOMReady=function(){console.log("nothing set for DOM ready")}}HashTime.prototype._init=function(){var a=this;if(a.setLanding(),0==window.location.hash.length){var b=String(a.landingHTMLPage).replace(".html","");""==b&&(b="index"),a.landinghash=b,a.currenthash=b,window.location.replace("#"+HT.hashPrefix+b)}else{var c=String(window.location.hash).split("?"),d=c[0];d=String(d).replace("#","");var e="",f=!1;if("undefined"!=typeof c[1]&&(e=c[1],f=!0),f)return d=String(d).replace(HT.hashPrefix,""),location.href=a.landingHTMLPage+"?"+e+"#"+HT.hashPrefix+d,!1;console.log("clean hash",d),d==a.hashPrefix&&(d=a.hashPrefix+"index"),a.landinghash=d,a.currenthash=d,window.location.hash=d}a.URLParameters=a._GET(),a.URLQuery=a._query()},HashTime.prototype.init=function(){var a=this;a.setAppTemplate(),window.location.hash=a.landinghash,a.render()},HashTime.prototype._GET=function(a){var b=this,c=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+location.pathname+(location.search?location.search:""),d=[];if(0==b.URLParameters.length){var e={};String(c).replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(a,b,c){e[b]=void 0!==c?c:""}),d=e}else d=b.URLParameters;return a?d[a]?d[a]:null:d},HashTime.prototype.imagePreload=function(){for(var a=this,b=a.imagesToPreload,c=0;c<b.length;c++)console.log("preloading image",b[c]),(new Image).src=b[c]},HashTime.prototype.render=function(){window.scrollTo(0,0);var a=this,b=a.sharedtemplatedata,c="is-",d=a.currenthash,e=String(d).replace("#","");e=String(e).replace(a.hashPrefix,""),0==e.length&&(e=String(a.landingHTMLPage).replace(".html","")),"undefined"!=typeof a.templatedata[e]&&(console.log("HashTime.templatedata[nohash]",a.templatedata[e]),b=jQuery.extend({},a.sharedtemplatedata,a.templatedata[e]));var f=function(a){var b=c+a,d=b.replace(/-([a-z])/g,function(a){return a[1].toUpperCase()});return d};b[f(e)]=!0,a._setPageTitle(),a.renderedTPL!=e&&$("body").html(a.template(b),function(){console.log("render!",b),a.renderedTPL=e,a.onDOMReady()})},HashTime.prototype._query=function(a){var b=this,c="?",d=[];return"undefined"!=typeof a&&(d=a),$.each(b.URLParameters,function(a,b){jQuery.inArray(a,d)!==-1||(c+=a+"="+b+"&")}),c},HashTime.prototype._query2array=function(){var a=this,b={};return console.log("URLQuery",a._query()),String(a._query()).replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(a,c,d){switch(c){default:b[c]=void 0!==d?d:""}}),b},HashTime.prototype.isTouchDevice=function(){return"ontouchstart"in window},HashTime.prototype._registerPartial=function(a){return!!(a&&$("[data-template-name='"+a+"']").length>0)&&(Handlebars.registerPartial(a,$("[data-template-name='"+a+"']").html()),!0)},HashTime.prototype.setPreloadImages=function(a){var b=this;"[object Array]"===Object.prototype.toString.call(a)&&(b.imagesToPreload=a)},HashTime.prototype.setTitleData=function(a,b){var c=this;"undefined"==typeof c.titledata[a]&&(c.titledata[a]=""),c.titledata[a]=String(b)},HashTime.prototype.setTitleObj=function(a){var b=this;"object"==typeof a&&$.each(a,function(a,c){"undefined"==typeof b.titledata[a]&&(b.titledata[a]=""),b.titledata[a]=String(c)})},HashTime.prototype._setPageTitle=function(){var a=this,b="",c=String(a.currenthash).replace("#","");c=String(c).replace(a.hashPrefix,""),""==c&&(c="index"),"undefined"!=typeof a.titledata[c]&&(b=a.titledata[c]),document.title=b},HashTime.prototype.setTemplateData=function(a,b){var c=this;"object"==typeof a&&b?c.sharedtemplatedata=jQuery.extend(a,c.sharedtemplatedata):"object"==typeof a&&$.each(a,function(a,b){"undefined"==typeof c.templatedata[a]&&(c.templatedata[a]={}),$.each(b,function(b,d){c.templatedata[a][b]=d})})},HashTime.prototype.setPartials=function(a){var b=this,c=!0;if(console.log("arr",a),"[object Array]"===Object.prototype.toString.call(a))for(var d=0;d<a.length;d++){var e=a[d],f=b._registerPartial(e);if(!f){console.log("Failed to register partial! - Cannot proceed.",e),c=!1;break}b.partials.push(e)}else c=!1;return c},HashTime.prototype.setAppTemplate=function(){var a=this;if(null==a.template){if(console.log("setting template"),0==a.partials.length)return console.log("no partials"),!1;for(var b="{{#if ",c="is-",d=function(a){var b=c+a,d=b.replace(/-([a-z])/g,function(a){return a[1].toUpperCase()});return d},e=0;e<a.partials.length;e++){var f=a.partials[e],g=d(f);0==e?(b+=g,b+="}}{{>"+f+"}}"):(b+="{{else if "+g+"}}",b+="{{>"+f+"}}")}b+="{{/if}}",console.log("hbIF",b);var h=b;return a.template=Handlebars.compile(h),!0}},HashTime.prototype.setLanding=function(){var a=this,b=location.pathname.substring(location.pathname.lastIndexOf("/")+1);a.landingHTMLPage=b},HashTime.prototype.navBack=function(){var a=this,b=function(a,b){var c=[];return c=$.grep(b,function(b){return b!=a})},c=a.lasthashes.indexOf(window.location.hash);c&&(console.log("found route! now lets try to go back!",a.lasthashes,c,history),a.lasthashes=b(window.location.hash,a.lasthashes),a.lasthash=window.location.hash),window.location.hash=a.lasthashes.pop()};var HT=!1;!function(a){var b=a.fn.html;a.fn.html=function(a,c){var d=b.apply(this,arguments);return"function"==typeof c&&c(),d},HT=new HashTime,HT.lasthashes.push(window.location.hash),a(window).on("hashchange",function(a){console.log("lasthashes",HT.lasthashes),HT.lasthashes.push(window.location.hash),HT.currenthash=window.location.hash;var b=String(window.location.hash).replace("#","");b=b.replace(HT.hashPrefix,""),jQuery.inArray(b,HT.partials)!==-1?HT.render():(console.log("partial not found - default to index"),window.location.hash="#"+HT.hashPrefix+"index")}),HT._init()}(jQuery,Handlebars);