function HashTime(e,t){this.hashPrefix="/",this.landinghash="",this.lasthash="",this.currenthash="",this.landingHTMLPage="",this.URLParameters=[],this.URLQuery="",this.titledata={},this.templatedata={},this.template=null,this.sharedtemplatedata={},this.partials=[],this.imagesToPreload=[],this.onDOMReady=function(){console.log("nothing set for DOM ready")}}HashTime.prototype._init=function(){var e=this;if(e.setLanding(),0==window.location.hash.length){var t=String(e.landingHTMLPage).replace(".html","");""==t&&(t="index"),window.location.hash=HT.hashPrefix+t,e.landinghash=window.location.hash,e.currenthash=window.location.hash}else{var a=String(window.location.hash).split("?"),n=a[0];n=String(n).replace("#","");var i="",r=!1;if("undefined"!=typeof a[1]&&(i=a[1],r=!0),r)return location.href=e.landingHTMLPage+"?"+i+HT.hashPrefix+n,!1;console.log("clean hash",n),n==e.hashPrefix&&(n=e.hashPrefix+"index"),e.landinghash=n,e.currenthash=n,window.location.hash=n}e.URLParameters=e._GET(),e.URLQuery=e._query()},HashTime.prototype.init=function(){var e=this;e.setAppTemplate(),window.location.hash=e.landinghash,e.render()},HashTime.prototype._GET=function(e){var t=this,a=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+location.pathname+(location.search?location.search:""),n=[];if(0==t.URLParameters.length){var i={};String(a).replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(e,t,a){i[t]=void 0!==a?a:""}),n=i}else n=t.URLParameters;return e?n[e]?n[e]:null:n},HashTime.prototype.imagePreload=function(){for(var e=this,t=e.imagesToPreload,a=0;a<t.length;a++)console.log("preloading image",t[a]),(new Image).src=t[a]},HashTime.prototype.render=function(){window.scrollTo(0,0);var e=this,t=e.sharedtemplatedata,a="is-",n=e.currenthash,i=String(n).replace("#","");i=String(i).replace(e.hashPrefix,""),0==i.length&&(i=String(e.landingHTMLPage).replace(".html","")),"undefined"!=typeof e.templatedata[i]&&(console.log("HashTime.templatedata[nohash]",e.templatedata[i]),t=jQuery.extend({},e.sharedtemplatedata,e.templatedata[i]));var r=function(e){var t=a+e,n=t.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()});return n};t[r(i)]=!0,e._setPageTitle(),$("body").html(e.template(t),function(){console.log("render!",t),e.onDOMReady()})},HashTime.prototype._query=function(e){var t=this,a="?",n=[];return"undefined"!=typeof e&&(n=e),$.each(t.URLParameters,function(e,t){-1!==jQuery.inArray(e,n)||(a+=e+"="+t+"&")}),a},HashTime.prototype._query2array=function(){var e=this,t={};return console.log("MayflowerApp.URLQuery",e._query()),String(e._query()).replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(e,a,n){switch(a){default:t[a]=void 0!==n?n:""}}),t},HashTime.prototype.isTouchDevice=function(){return"ontouchstart"in window},HashTime.prototype._registerPartial=function(e){return e&&$("[data-template-name='"+e+"']").length>0?(Handlebars.registerPartial(e,$("[data-template-name='"+e+"']").html()),!0):!1},HashTime.prototype.setPreloadImages=function(e){var t=this;"[object Array]"===Object.prototype.toString.call(e)&&(t.imagesToPreload=e)},HashTime.prototype.setTitleData=function(e,t){var a=this;"undefined"==typeof a.titledata[e]&&(a.titledata[e]=""),a.titledata[e]=String(t)},HashTime.prototype.setTitleObj=function(e){var t=this;"object"==typeof e&&$.each(e,function(e,a){"undefined"==typeof t.titledata[e]&&(t.titledata[e]=""),t.titledata[e]=String(a)})},HashTime.prototype._setPageTitle=function(){var e=this,t="",a=String(e.currenthash).replace("#","");a=String(a).replace(e.hashPrefix,""),""==a&&(a="index"),"undefined"!=typeof e.titledata[a]&&(t=e.titledata[a]),document.title=t},HashTime.prototype.setTemplateData=function(e,t){var a=this;"object"==typeof e&&t?a.sharedtemplatedata=jQuery.extend(e,a.sharedtemplatedata):"object"==typeof e&&$.each(e,function(e,t){"undefined"==typeof a.templatedata[e]&&(a.templatedata[e]={}),$.each(t,function(t,n){a.templatedata[e][t]=n})})},HashTime.prototype.setPartials=function(e){var t=this,a=!0;if(console.log("arr",e),"[object Array]"===Object.prototype.toString.call(e))for(var n=0;n<e.length;n++){var i=e[n],r=t._registerPartial(i);if(!r){console.log("Failed to register partial! - Cannot proceed.",i),a=!1;break}t.partials.push(i)}else a=!1;return a},HashTime.prototype.setAppTemplate=function(){var e=this;if(null==e.template){if(console.log("setting template"),0==e.partials.length)return console.log("no partials"),!1;for(var t="{{#if ",a="is-",n=function(e){var t=a+e,n=t.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()});return n},i=0;i<e.partials.length;i++){var r=e.partials[i],o=n(r);0==i?(t+=o,t+="}}{{>"+r+"}}"):(t+="{{else if "+o+"}}",t+="{{>"+r+"}}")}t+="{{/if}}",console.log("hbIF",t);var l=t;return e.template=Handlebars.compile(l),!0}},HashTime.prototype.setLanding=function(){var e=this,t=location.pathname.substring(location.pathname.lastIndexOf("/")+1);e.landingHTMLPage=t};var HT=!1;!function(e){var t=e.fn.html;e.fn.html=function(e,a){var n=t.apply(this,arguments);return"function"==typeof a&&a(),n},HT=new HashTime;var a=function(e){var t=String(e.oldURL).replace(/^.*?(#|$)/,""),a=String(e.newURL).replace(/^.*?(#|$)/,"");console.log("hash transition ",t,a),HT.lasthash=t,HT.currenthash=a,""==HT.currenthash&&(window.location.hash=HT.hashPrefix+"index"),""==HT.lasthash&&(HT.lasthash=HT.currenthash);var n=String(HT.currenthash).replace("#","");n=String(n).replace(HT.suffixPrefix,"");var i=String(HT.lasthash).replace("#","");i=String(i).replace(HT.suffixPrefix,""),console.log("new,old",n,i),n===i?console.log("dont rerender"):n==HT.hashPrefix||""==n?window.location.hash=HT.hashPrefix+"index":HT.render()};if("onhashchange"in window)window.addEventListener?window.addEventListener("hashchange",a,!1):window.attachEvent&&window.attachEvent("onhashchange",a);else{var n=location.href;setInterval(function(){var e=location.href;if(n!==e){var t=n;n=e,a.call(window,{type:"hashchange",newURL:e,oldURL:t})}},100)}HT._init()}(jQuery,Handlebars);