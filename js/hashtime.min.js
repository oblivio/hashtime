function HashTime(t,e){this.landinghash="",this.lasthash="",this.currenthash="",this.landingHTMLPage="",this.URLParameters=[],this.URLQuery="",this.titledata={},this.templatedata={},this.template=null,this.sharedtemplatedata={},this.partials=[],this.imagesToPreload=[],this.onDOMReady=function(){console.log("nothing set for DOM ready")}}HashTime.prototype._init=function(){var t=this;if(t.setLanding(),0==window.location.hash.length){var e=String(t.landingHTMLPage).replace(".html","");""==e&&(e="index"),window.location.hash=e,t.currenthash=window.location.hash,t.landinghash=window.location.hash}else{var a=String(window.location.hash).split("?"),n=a[0],i="",o=!1;if("undefined"!=typeof a[1]&&(i=a[1],o=!0),o)return location.href=t.landingHTMLPage+"?"+i+n,!1;t.landinghash=window.location.hash,t.currenthash=window.location.hash}t.URLParameters=t._GET(),t.URLQuery=t._query()},HashTime.prototype.init=function(){var t=this;t.setAppTemplate(),t.render()},HashTime.prototype._GET=function(t){var e=this,a=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+location.pathname+(location.search?location.search:""),n=[];if(0==e.URLParameters.length){var i={};String(a).replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(t,e,a){i[e]=void 0!==a?a:""}),n=i}else n=e.URLParameters;return t?n[t]?n[t]:null:n},HashTime.prototype.imagePreload=function(){for(var t=this,e=t.imagesToPreload,a=0;a<e.length;a++)console.log("preloading image",e[a]),(new Image).src=e[a]},HashTime.prototype.render=function(){var t=this,e=t.sharedtemplatedata,a="is-",n=window.location.hash,i=String(n).replace("#","");0==i.length&&(i=String(t.landingHTMLPage).replace(".html","")),"undefined"!=typeof t.templatedata[i]&&(console.log("HashTime.templatedata[nohash]",t.templatedata[i]),e=jQuery.extend({},t.sharedtemplatedata,t.templatedata[i]));var o=function(t){var e=a+t,n=e.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()});return n};e[o(i)]=!0,t._setPageTitle(),$("body").html(t.template(e),function(){console.log("render!",e),t.onDOMReady()})},HashTime.prototype._query=function(t){var e=this,a="?",n=[];return"undefined"!=typeof t&&(n=t),$.each(e.URLParameters,function(t,e){-1!==jQuery.inArray(t,n)||(a+=t+"="+e+"&")}),a},HashTime.prototype._query2array=function(){var t=this,e={};return console.log("MayflowerApp.URLQuery",t._query()),String(t._query()).replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(t,a,n){switch(a){default:e[a]=void 0!==n?n:""}}),e},HashTime.prototype.isTouchDevice=function(){return"ontouchstart"in window},HashTime.prototype._registerPartial=function(t){return t&&$("[data-template-name='"+t+"']").length>0?(Handlebars.registerPartial(t,$("[data-template-name='"+t+"']").html()),!0):!1},HashTime.prototype.setPreloadImages=function(t){var e=this;"[object Array]"===Object.prototype.toString.call(t)&&(e.imagesToPreload=t)},HashTime.prototype.setTitleData=function(t,e){var a=this;"undefined"==typeof a.titledata[t]&&(a.titledata[t]=""),a.titledata[t]=String(e)},HashTime.prototype.setTitleObj=function(t){var e=this;"object"==typeof t&&$.each(t,function(t,a){"undefined"==typeof e.titledata[t]&&(e.titledata[t]=""),e.titledata[t]=String(a)})},HashTime.prototype._setPageTitle=function(){var t=this,e="",a=String(t.currenthash).replace("#","");""==a&&(a="index"),"undefined"!=typeof t.titledata[a]&&(e=t.titledata[a]),document.title=e},HashTime.prototype.setTemplateData=function(t,e){var a=this;"object"==typeof t&&e?a.sharedtemplatedata=jQuery.extend(t,a.sharedtemplatedata):"object"==typeof t&&$.each(t,function(t,e){"undefined"==typeof a.templatedata[t]&&(a.templatedata[t]={}),$.each(e,function(e,n){a.templatedata[t][e]=n})})},HashTime.prototype.setPartials=function(t){var e=this,a=!0;if(console.log("arr",t),"[object Array]"===Object.prototype.toString.call(t))for(var n=0;n<t.length;n++){var i=t[n],o=e._registerPartial(i);if(!o){console.log("Failed to register partial! - Cannot proceed.",i),a=!1;break}e.partials.push(i)}else a=!1;return a},HashTime.prototype.setAppTemplate=function(){var t=this;if(null==t.template){if(console.log("setting template"),0==t.partials.length)return console.log("no partials"),!1;for(var e="{{#if ",a="is-",n=function(t){var e=a+t,n=e.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()});return n},i=0;i<t.partials.length;i++){var o=t.partials[i],r=n(o);0==i?(e+=r,e+="}}{{>"+o+"}}"):(e+="{{else if "+r+"}}",e+="{{>"+o+"}}")}e+="{{/if}}",console.log("hbIF",e);var l=e;return t.template=Handlebars.compile(l),!0}},HashTime.prototype.setLanding=function(){var t=this,e=location.pathname.substring(location.pathname.lastIndexOf("/")+1);t.landingHTMLPage=e};var HT=!1;!function(t){var e=t.fn.html;t.fn.html=function(t,a){var n=e.apply(this,arguments);return"function"==typeof a&&a(),n},HT=new HashTime;var a=function(t){var e=String(t.oldURL).replace(/^.*?(#|$)/,""),a=String(t.newURL).replace(/^.*?(#|$)/,"");console.log("hash transition ",e,a),HT.lasthash=e,HT.currenthash=a,HT.render()};if("onhashchange"in window)window.addEventListener?window.addEventListener("hashchange",a,!1):window.attachEvent&&window.attachEvent("onhashchange",a);else{var n=location.href;setInterval(function(){var t=location.href;if(n!==t){var e=n;n=t,a.call(window,{type:"hashchange",newURL:t,oldURL:e})}},100)}HT._init()}(jQuery,Handlebars);